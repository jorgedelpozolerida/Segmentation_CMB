1702484442606 jorge-gram info ClearML Task: created new task id=33c86ad33971491198be47643d92e14f
ClearML results page: https://130.61.76.150:8080/projects/6b7c41ee8a4040f2ab35e09b02bbccde/experiments/33c86ad33971491198be47643d92e14f/output/log
1702484443700 jorge-gram error 2023-12-13 17:20:43 WARNING  Git repository is not clean. Consider committing changes before running a ClearML task
2023-12-13 17:20:43 INFO     Converting all Path objects in config to relative strings.
2023-12-13 17:20:44 INFO     Submitting task to remote worker queue single-gpu.
1702484445188 jorge-gram info ClearML Monitor: GPU monitoring failed getting GPU reading, switching off GPU monitoring
1702484455518 cerebriu-research-bm48gpu-instance-2:gpu4 INFO task 33c86ad33971491198be47643d92e14f pulled from b94f6b05a58940f48b30e9bf09fd411b by worker cerebriu-research-bm48gpu-instance-2:gpu4

1702484460696 cerebriu-research-bm48gpu-instance-2:gpu4 DEBUG InsecureRequestWarning: Certificate verification is disabled! Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/latest/advanced-usage.html#ssl-warnings
InsecureRequestWarning: Certificate verification is disabled! Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/latest/advanced-usage.html#ssl-warnings
Current configuration (clearml_agent v1.5.2, location: /tmp/.clearml_agent.zbvyf_ea.cfg):
----------------------
agent.worker_id = cerebriu-research-bm48gpu-instance-2:gpu4
agent.worker_name = cerebriu-research-bm48gpu-instance-2
agent.force_git_ssh_protocol = false
agent.python_binary = 
agent.package_manager.type = pip
agent.package_manager.pip_version.0 = <20.2 ; python_version < '3.10'
agent.package_manager.pip_version.1 = <22.3 ; python_version >\= '3.10'
agent.package_manager.system_site_packages = false
agent.package_manager.force_upgrade = false
agent.package_manager.conda_channels.0 = pytorch
agent.package_manager.conda_channels.1 = conda-forge
agent.package_manager.conda_channels.2 = defaults
agent.package_manager.priority_optional_packages.0 = pygobject
agent.package_manager.torch_nightly = false
agent.package_manager.poetry_files_from_repo_working_dir = false
agent.venvs_dir = /4_datadrive/clearml/venvs-builds.5
agent.venvs_cache.max_entries = 10
agent.venvs_cache.free_space_threshold_gb = 2.0
agent.venvs_cache.path = /4_datadrive/clearml/venvs-cache
agent.vcs_cache.enabled = true
agent.vcs_cache.path = /4_datadrive/clearml/vcs-cache
agent.venv_update.enabled = false
agent.pip_download_cache.enabled = true
agent.pip_download_cache.path = /4_datadrive/clearml/pip-download-cache
agent.translate_ssh = true
agent.reload_config = false
agent.docker_pip_cache = /4_datadrive/clearml/pip-cache
agent.docker_apt_cache = /4_datadrive/clearml/apt-cache.5
agent.docker_force_pull = false
agent.default_docker.image = nvidia/cuda:11.0.3-cudnn8-runtime-ubuntu20.04
agent.enable_task_env = false
agent.hide_docker_command_env_vars.enabled = true
agent.hide_docker_command_env_vars.parse_embedded_urls = true
agent.abort_callback_max_timeout = 1800
agent.docker_internal_mounts.sdk_cache = /clearml_agent_cache
agent.docker_internal_mounts.apt_cache = /var/cache/apt/archives
agent.docker_internal_mounts.ssh_folder = ~/.ssh
agent.docker_internal_mounts.ssh_ro_folder = /.ssh
agent.docker_internal_mounts.pip_cache = /root/.cache/pip
agent.docker_internal_mounts.poetry_cache = /root/.cache/pypoetry
agent.docker_internal_mounts.vcs_cache = /root/.clearml/vcs-cache
agent.docker_internal_mounts.venv_build = ~/.clearml/venvs-builds
agent.docker_internal_mounts.pip_download = /root/.clearml/pip-download-cache
agent.apply_environment = true
agent.apply_files = true
agent.custom_build_script = 
agent.disable_task_docker_override = false
agent.git_user = perslev
agent.default_python = 3.11
agent.cuda_version = 114
agent.cudnn_version = 0
api.version = 1.5
api.verify_certificate = false
api.default_version = 1.5
api.http.max_req_size = 15728640
api.http.retries.total = 240
api.http.retries.connect = 240
api.http.retries.read = 240
api.http.retries.redirect = 240
api.http.retries.status = 240
api.http.retries.backoff_factor = 1.0
api.http.retries.backoff_max = 120.0
api.http.wait_on_mainte'nan'ce_forever = true
api.http.pool_maxsize = 512
api.http.pool_connections = 512
api.api_server = https://130.61.76.150:8008
api.web_server = https://130.61.76.150:8080
api.files_server = s3://cerebriu-research-mlops/clearml/mlops-server
api.credentials.access_key = LA1XBPKXZJ7Q46QYXSL7
api.host = https://130.61.76.150:8008
sdk.storage.cache.default_base_dir = /4_datadrive/clearml/cache
sdk.storage.cache.size.min_free_bytes = 10GB
sdk.storage.direct_access.0.url = file://*
sdk.metrics.file_history_size = 100
sdk.metrics.matplotlib_untitled_history_size = 100
sdk.metrics.images.format = JPEG
sdk.metrics.images.quality = 87
sdk.metrics.images.subsampling = 0
sdk.metrics.tensorboard_single_series_per_graph = false
sdk.network.metrics.file_upload_threads = 4
sdk.network.metrics.file_upload_starvation_warning_sec = 120
sdk.network.iteration.max_retries_on_server_error = 5
sdk.network.iteration.retry_backoff_factor_sec = 10
sdk.network.file_upload_retries = 3
sdk.aws.s3.key = 
sdk.aws.s3.region = 
sdk.aws.s3.credentials.0.bucket = cerebriu-research-mlops
sdk.aws.s3.credentials.0.region = eu-west-1
sdk.aws.s3.credentials.0.key = AKIAYLVE23TZC2PWO4W2
sdk.aws.s3.use_credentials_chain = false
sdk.aws.boto3.pool_connections = 512
sdk.aws.boto3.max_multipart_concurrency = 16
sdk.log.null_log_propagate = false
sdk.log.task_log_buffer_capacity = 66
sdk.log.disable_urllib3_info = true
sdk.development.task_reuse_time_window_in_hours = 72.0
sdk.development.vcs_repo_detect_async = true
sdk.development.store_uncommitted_code_diff = true
sdk.development.support_stopping = true
sdk.development.default_output_uri = 
sdk.development.force_analyze_entire_repo = false
sdk.development.suppress_update_message = false
sdk.development.detect_with_pip_freeze = false
sdk.development.worker.report_period_sec = 2
sdk.development.worker.ping_period_sec = 30
sdk.development.worker.log_stdout = true
sdk.development.worker.report_global_mem_used = false
sdk.development.worker.report_event_flush_threshold = 100
sdk.development.worker.console_cr_flush_period = 10
sdk.apply_environment = false
sdk.apply_files = false

Executing task id [33c86ad33971491198be47643d92e14f]:
repository = https://bitbucket.org/cerebriu/cerebriu-research-mlops.git
branch = jorge_dev
version_num = 78c411c9b9d76fcc002981ee4453338aa2f17644
tag = 
docker_cmd = 
entry_point = crbr/commands/main.py
working_dir = 


1702484465721 cerebriu-research-bm48gpu-instance-2:gpu4 DEBUG ::: Using Cached environment /4_datadrive/clearml/venvs-cache/9a17d334f9d2c6a8f673d6031acb1c59.d45459cec2442ebeb98213e970574604 :::
Using cached repository in "/4_datadrive/clearml/vcs-cache/cerebriu-research-mlops.git.e69699c1df6f90b3005442a9cd39f36c/cerebriu-research-mlops.git"
Note: switching to '78c411c9b9d76fcc002981ee4453338aa2f17644'.

You are in 'detached HEAD' state. You can look around, make experimental
changes and commit them, and you can discard any commits you make in this
state without impacting any branches by switching back to a branch.

If you want to create a new branch to retain commits you create, you may
do so (now or later) by using -c with the switch command. Example:

  git switch -c <new-branch-name>

Or undo this operation with:

  git switch -

Turn off this advice by setting config variable advice.detachedHead to false

HEAD is now at 78c411c Merge remote-tracking branch 'origin/dev' into jorge_dev
type: git
url: https://bitbucket.org/cerebriu/cerebriu-research-mlops.git
branch: HEAD
commit: 78c411c9b9d76fcc002981ee4453338aa2f17644
root: /4_datadrive/clearml/venvs-builds.5/3.11/task_repository/cerebriu-research-mlops.git
Applying uncommitted changes
Executing: ('git', 'apply', '--unidiff-zero'): b'<stdin>:36: trailing whitespace.\n            that overlap with at least \'min_overlap_voxels\' voxels to a true foreground connected \n<stdin>:120: trailing whitespace.\n    """ \n<stdin>:121: trailing whitespace.\n    Accumulated counts evaluation class. This class accumulates counts of \n<stdin>:329: trailing whitespace.\n    \nwarning: 4 lines add whitespace errors.\n'


Adding venv into cache: /4_datadrive/clearml/venvs-builds.5/3.11
Running task id [33c86ad33971491198be47643d92e14f]:
[.]$ /4_datadrive/clearml/venvs-builds.5/3.11/bin/python -u crbr/commands/main.py
Summary - installed python packages:
pip:
- absl-py==2.0.0
- antlr4-python3-runtime==4.9.3
- astunparse==1.6.3
- attrs==23.1.0
- bcrypt==4.0.1
- boto3==1.28.79
- botocore==1.31.85
- cachetools==5.3.2
- certifi==2023.11.17
- charset-normalizer==3.3.2
- clearml==1.13.1
- contourpy==1.2.0
- cycler==0.12.1
- Cython==3.0.6
- dipy==1.7.0
- flatbuffers==23.5.26
- fonttools==4.46.0
- furl==2.1.3
- gast==0.5.4
- gitdb==4.0.11
- GitPython==3.1.40
- google-auth==2.24.0
- google-auth-oauthlib==1.0.0
- google-pasta==0.2.0
- grpcio==1.59.3
- h5py==3.10.0
- idna==3.6
- imageio==2.33.0
- jmespath==1.0.1
- joblib==1.3.2
- jsonschema==4.20.0
- jsonschema-specifications==2023.11.2
- keras==2.14.0
- kiwisolver==1.4.5
- lazy_loader==0.3
- libclang==16.0.6
- lxml==4.9.3
- Markdown==3.5.1
- MarkupSafe==2.1.3
- matplotlib==3.8.1
- ml-dtypes==0.2.0
- networkx==3.2.1
- nibabel==5.1.0
- nilearn==0.10.2
- numpy==1.26.2
- oauthlib==3.2.2
- omegaconf==2.3.0
- opt-einsum==3.3.0
- orderedmultidict==1.0.1
- packaging==23.2
- pandas==2.1.3
- pathlib2==2.3.7.post1
- Pillow==10.1.0
- protobuf==4.25.1
- psutil==5.9.6
- pyasn1==0.5.1
- pyasn1-modules==0.3.0
- PyJWT==2.4.0
- pyparsing==3.1.1
- python-dateutil==2.8.2
- pytz==2023.3.post1
- PyYAML==6.0.1
- referencing==0.31.1
- requests==2.31.0
- requests-oauthlib==1.3.1
- rpds-py==0.13.2
- rsa==4.9
- s3transfer==0.7.0
- scikit-image==0.22.0
- scikit-learn==1.3.2
- scipy==1.11.3
- SimpleITK==2.2.1
- six==1.16.0
- smmap==5.0.1
- tensorboard==2.14.1
- tensorboard-data-server==0.7.2
- tensorflow==2.14.0
- tensorflow-estimator==2.14.0
- tensorflow-io-gcs-filesystem==0.34.0
- termcolor==2.4.0
- threadpoolctl==3.2.0
- tifffile==2023.9.26
- tqdm==4.66.1
- typing_extensions==4.8.0
- tzdata==2023.3
- urllib3==2.0.7
- Werkzeug==3.0.1
- wrapt==1.14.1

Environment setup completed successfully

Starting Task Execution:


1702484470686 cerebriu-research-bm48gpu-instance-2:gpu4 DEBUG 2023-12-13 16:21:05.697674: E tensorflow/compiler/xla/stream_executor/cuda/cuda_dnn.cc:9342] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2023-12-13 16:21:05.697782: E tensorflow/compiler/xla/stream_executor/cuda/cuda_fft.cc:609] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2023-12-13 16:21:05.697809: E tensorflow/compiler/xla/stream_executor/cuda/cuda_blas.cc:1518] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2023-12-13 16:21:05.704923: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-12-13 16:21:06.474005: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
2023-12-13 16:21:07 WARNING  InsecureRequestWarning: Certificate verification is disabled! Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/latest/advanced-usage.html#ssl-warnings
ClearML results page: https://130.61.76.150:8080/projects/6b7c41ee8a4040f2ab35e09b02bbccde/experiments/33c86ad33971491198be47643d92e14f/output/log
2023-12-13 16:21:07 INFO     Running task 33c86ad33971491198be47643d92e14f remotely.
2023-12-13 16:21:07 INFO     Fetching config 'args' from ClearML Task '33c86ad33971491198be47643d92e14f'.
2023-12-13 16:21:07 INFO     Read config 'args' from ClearML task.
2023-12-13 16:21:07 INFO     Fetching config 'evaluation' from ClearML Task '33c86ad33971491198be47643d92e14f'.
2023-12-13 16:21:07 INFO     Read config 'evaluation' from ClearML task.
2023-12-13 16:21:07 INFO     Fetching config 'experiment' from ClearML Task '33c86ad33971491198be47643d92e14f'.
2023-12-13 16:21:07 INFO     Read config 'experiment' from ClearML task.
2023-12-13 16:21:07 INFO     Running with ClearML mode: 'remote'
2023-12-13 16:21:07 INFO     Parsed arguments: {'add_evaluations_to_model': False, 'clearml_mode': 'remote', 'command': 'evaluate', 'dataset_id': '86485852980d44f49b059567b397f121', 'evaluations': ['segmentation', 'accumulated_segmentation', 'classification', 'accumulated_classification', 'counts', 'accumulated_counts'], 'local_run_dir': None, 'log_level': 'INFO', 'model_id': None, 'prediction_task_id': 'aa61d3f206bd44899fcc6d6e45072d80', 'project_folder': '.', 'project_name': 'CMB/3Dunet', 'seed': 42, 'splits': ['valid'], 'splits_file': 'splits.json', 'study_folders_pattern': '*', 'tags': ['eval-split', 'patch80', 'diceloss'], 'task_description': None, 'task_name': 'valdo-3Dunet-eval', 'tf_min_log_level': '2', 'worker_queue_name': 'single-gpu'}
2023-12-13 16:21:07 INFO     Setting global seed to 42
2023-12-13 16:21:07 INFO     Importing module 'crbr.commands.evaluate'
2023-12-13 16:21:08 INFO     Running command: evaluate in module crbr.commands.evaluate (task=33c86ad33971491198be47643d92e14f) from dir /tmp/tmpsmsx3hj4/CMB/3Dunet/valdo-3Dunet-eval
2023-12-13 16:21:08 INFO     Setting task 33c86ad33971491198be47643d92e14f type to 'testing'
2023-12-13 16:21:08 INFO     Prediction task aa61d3f206bd44899fcc6d6e45072d80 has 1 prediction artefact(s).
2023-12-13 16:21:08 INFO     Found prediction artefact with model_id 10142675e5de427793e963efc6474009 and dataset_id 86485852980d44f49b059567b397f121. Running evaluation now.
2023-12-13 16:21:08 INFO     Stotred local copy of artefact 'prediction-10142675e5de427793e963efc6474009-86485852980d44f49b059567b397f121-valid' in folder '/4_datadrive/clearml/cache/storage_manager/global/8195e365035edcaaffb5bae6c5e9de7c.valdo-3Dunet-pred_artifacts_archive_prediction-10142675e5de427793e963efc6474009-86485852980d44f49b059567b397f121-valid'
2023-12-13 16:21:08,848 - clearml - INFO - Dataset.get() did not specify alias. Dataset information will not be automatically logged in ClearML Server.
2023-12-13 16:21:08 INFO     Dataset not locally available. Attempting to automatically download.
2023-12-13 16:21:08 INFO     Fetching dataset: [ID=None, name='VALDO', version=2] from ClearML
2023-12-13 16:21:09 INFO     Dataset has tags: ['T2S-space', 'isotropic=0.5', 'nifty', 'processed']
2023-12-13 16:21:09 INFO     Dataset is not zipped. Leaving in as-is in default ClearML cache.
2023-12-13 16:21:09 INFO     Dataset downloaded to /4_datadrive/clearml/cache/storage_manager/datasets/ds_86485852980d44f49b059567b397f121
2023-12-13 16:21:09 INFO     Found 72 study folders.
2023-12-13 16:21:09 INFO     Loading splits from file /4_datadrive/clearml/cache/storage_manager/datasets/ds_86485852980d44f49b059567b397f121/splits.json
2023-12-13 16:21:09 INFO     Skipping split train.
2023-12-13 16:21:09 INFO     Creating dataset for split valid with 22 studies.
2023-12-13 16:21:09 INFO     Loaded dataset split valid with 22 samples.
2023-12-13 16:21:09 INFO     Loaded dataset with 1 splits: {'valid': MRIStudyDataset(len(mri_study_configs)=22, load_sequence_spec=SequenceSpec(T2S), metadata=False, transform=False)}
2023-12-13 16:21:09 INFO     Initialized running evaluation for split 'valid' (dataset MRIStudyDataset(len(mri_study_configs)=22, load_sequence_spec=SequenceSpec(T2S), metadata=False, transform=False))
2023-12-13 16:21:09 INFO     Found 22 prediction files for 22 studies.
2023-12-13 16:21:09 INFO     Getting segmentation to classification converter pixel_count with kwargs {'n_classes': 2, 'conversion_map': None}
2023-12-13 16:21:09 INFO     Using pixel thresholds: {1: 1}
2023-12-13 16:21:09 INFO     Using segmentation -> classification converter: PixelCountSegmentationToClassificationConverter({'conversion_map': None, 'num_pixels_thresholds': {1: 1}, 'negative_class_index': 0, 'max_class_in_map': 1, 'n_classes': 2})
2023-12-13 16:21:09 INFO     Evaluating 22 predictions with 6 evaluation(s):
                             - SegmentationEvaluation({'zero_division': 'nan', 'ignore_classes_in_avg': (0,)})
                             - AccumulatedSegmentationEvaluation({'zero_division': 'nan', 'ignore_classes_in_avg': (0,)})
                             - ClassificationEvaluation({})
                             - AcccumulatedClassificationEvaluation({})
                             - CountsEvaluation({'label_structure': array([[[ True,  True,  True],
                                     [ True,  True,  True],
                                     [ True,  True,  True]],
                             
                                    [[ True,  True,  True],
                                     [ True,  True,  True],
                                     [ True,  True,  True]],
                             
                                    [[ True,  True,  True],
                                     [ True,  True,  True],
                                     [ True,  True,  True]]]), 'min_overlap_voxels': 1})
                             - AccumulatedCountsEvaluation({'label_structure': array([[[ True,  True,  True],
                                     [ True,  True,  True],
                                     [ True,  True,  True]],
                             
                                    [[ True,  True,  True],
                                     [ True,  True,  True],
                                     [ True,  True,  True]],
                             
                                    [[ True,  True,  True],
                                     [ True,  True,  True],
                                     [ True,  True,  True]]]), 'min_overlap_voxels': 1})

1702484475642 cerebriu-research-bm48gpu-instance-2:gpu4 DEBUG 2023-12-13 16:21:12 INFO     [1/22] Evaluating study sub-104.

1702484480683 cerebriu-research-bm48gpu-instance-2:gpu4 DEBUG 2023-12-13 16:21:19 INFO     Study evaluation:
                             {'classification': {0: 'TP',
                                                 1: 'TN'},
                              'counts': {'predicted_counts': [0],
                                         'predicted_overlapping_counts': [0],
                                         'true_counts': [0]},
                              'segmentation': {'f1_0': 1.0,
                                               'f1_1': 'nan',
                                               'f1_avg': 'nan',
                                               'precision_0': 1.0,
                                               'precision_1': 'nan',
                                               'precision_avg': 'nan',
                                               'recall_0': 1.0,
                                               'recall_1': 'nan',
                                               'recall_avg': 'nan',
                                               'specificity_0': 'nan',
                                               'specificity_1': 1.0,
                                               'specificity_avg': 1.0}}

1702484485697 cerebriu-research-bm48gpu-instance-2:gpu4 DEBUG 2023-12-13 16:21:22 INFO     [2/22] Evaluating study sub-106.

1702484490738 cerebriu-research-bm48gpu-instance-2:gpu4 DEBUG 2023-12-13 16:21:30 INFO     Study evaluation:
                             {'classification': {0: 'TN',
                                                 1: 'TP'},
                              'counts': {'predicted_counts': [5],
                                         'predicted_overlapping_counts': [3],
                                         'true_counts': [3]},
                              'segmentation': {'f1_0': 0.9999968182367392,
                                               'f1_1': 0.605,
                                               'f1_avg': 0.605,
                                               'precision_0': 0.999995811353849,
                                               'precision_1': 0.6914285714285714,
                                               'precision_avg': 0.6914285714285714,
                                               'recall_0': 0.9999978251216572,
                                               'recall_1': 0.5377777777777778,
                                               'recall_avg': 0.5377777777777778,
                                               'specificity_0': 0.5377777777777778,
                                               'specificity_1': 0.9999978251216572,
                                               'specificity_avg': 0.9999978251216572}}

1702484495747 cerebriu-research-bm48gpu-instance-2:gpu4 DEBUG 2023-12-13 16:21:33 INFO     [3/22] Evaluating study sub-202.

1702484505797 cerebriu-research-bm48gpu-instance-2:gpu4 DEBUG 2023-12-13 16:21:41 INFO     Study evaluation:
                             {'classification': {0: 'TP',
                                                 1: 'TN'},
                              'counts': {'predicted_counts': [0],
                                         'predicted_overlapping_counts': [0],
                                         'true_counts': [0]},
                              'segmentation': {'f1_0': 1.0,
                                               'f1_1': 'nan',
                                               'f1_avg': 'nan',
                                               'precision_0': 1.0,
                                               'precision_1': 'nan',
                                               'precision_avg': 'nan',
                                               'recall_0': 1.0,
                                               'recall_1': 'nan',
                                               'recall_avg': 'nan',
                                               'specificity_0': 'nan',
                                               'specificity_1': 1.0,
                                               'specificity_avg': 1.0}}
2023-12-13 16:21:43 INFO     [4/22] Evaluating study sub-204.

1702484515829 cerebriu-research-bm48gpu-instance-2:gpu4 DEBUG 2023-12-13 16:21:51 INFO     Study evaluation:
                             {'classification': {0: 'TP',
                                                 1: 'TN'},
                              'counts': {'predicted_counts': [0],
                                         'predicted_overlapping_counts': [0],
                                         'true_counts': [0]},
                              'segmentation': {'f1_0': 1.0,
                                               'f1_1': 'nan',
                                               'f1_avg': 'nan',
                                               'precision_0': 1.0,
                                               'precision_1': 'nan',
                                               'precision_avg': 'nan',
                                               'recall_0': 1.0,
                                               'recall_1': 'nan',
                                               'recall_avg': 'nan',
                                               'specificity_0': 'nan',
                                               'specificity_1': 1.0,
                                               'specificity_avg': 1.0}}
2023-12-13 16:21:53 INFO     [5/22] Evaluating study sub-206.

1702484520862 cerebriu-research-bm48gpu-instance-2:gpu4 DEBUG 2023-12-13 16:22:00 INFO     Study evaluation:
                             {'classification': {0: 'FN',
                                                 1: 'FP'},
                              'counts': {'predicted_counts': [1],
                                         'predicted_overlapping_counts': [0],
                                         'true_counts': [0]},
                              'segmentation': {'f1_0': 0.9999991918096917,
                                               'f1_1': 0.0,
                                               'f1_avg': 0.0,
                                               'precision_0': 1.0,
                                               'precision_1': 0.0,
                                               'precision_avg': 0.0,
                                               'recall_0': 0.9999983836206896,
                                               'recall_1': 'nan',
                                               'recall_avg': 'nan',
                                               'specificity_0': 'nan',
                                               'specificity_1': 0.9999983836206896,
                                               'specificity_avg': 0.9999983836206896}}

1702484525867 cerebriu-research-bm48gpu-instance-2:gpu4 DEBUG 2023-12-13 16:22:03 INFO     [6/22] Evaluating study sub-208.

1702484535920 cerebriu-research-bm48gpu-instance-2:gpu4 DEBUG 2023-12-13 16:22:10 INFO     Study evaluation:
                             {'classification': {0: 'TN',
                                                 1: 'TP'},
                              'counts': {'predicted_counts': [1],
                                         'predicted_overlapping_counts': [1],
                                         'true_counts': [1]},
                              'segmentation': {'f1_0': 0.9999990974627422,
                                               'f1_1': 0.7857142857142857,
                                               'f1_avg': 0.7857142857142857,
                                               'precision_0': 0.9999993230969039,
                                               'precision_1': 0.7457627118644068,
                                               'precision_avg': 0.7457627118644068,
                                               'recall_0': 0.9999988718286822,
                                               'recall_1': 0.8301886792452831,
                                               'recall_avg': 0.8301886792452831,
                                               'specificity_0': 0.8301886792452831,
                                               'specificity_1': 0.9999988718286822,
                                               'specificity_avg': 0.9999988718286822}}
2023-12-13 16:22:13 INFO     [7/22] Evaluating study sub-213.

1702484545953 cerebriu-research-bm48gpu-instance-2:gpu4 DEBUG 2023-12-13 16:22:22 INFO     Study evaluation:
                             {'classification': {0: 'FP',
                                                 1: 'FN'},
                              'counts': {'predicted_counts': [0],
                                         'predicted_overlapping_counts': [0],
                                         'true_counts': [1]},
                              'segmentation': {'f1_0': 0.9999995496343707,
                                               'f1_1': 0.0,
                                               'f1_avg': 0.0,
                                               'precision_0': 0.999999099269147,
                                               'precision_1': 'nan',
                                               'precision_avg': 'nan',
                                               'recall_0': 1.0,
                                               'recall_1': 0.0,
                                               'recall_avg': 0.0,
                                               'specificity_0': 0.0,
                                               'specificity_1': 1.0,
                                               'specificity_avg': 1.0}}
2023-12-13 16:22:25 INFO     [8/22] Evaluating study sub-214.

1702484555984 cerebriu-research-bm48gpu-instance-2:gpu4 DEBUG 2023-12-13 16:22:33 INFO     Study evaluation:
                             {'classification': {0: 'FN',
                                                 1: 'FP'},
                              'counts': {'predicted_counts': [1],
                                         'predicted_overlapping_counts': [0],
                                         'true_counts': [0]},
                              'segmentation': {'f1_0': 0.9999993346316887,
                                               'f1_1': 0.0,
                                               'f1_avg': 0.0,
                                               'precision_0': 1.0,
                                               'precision_1': 0.0,
                                               'precision_avg': 0.0,
                                               'recall_0': 0.9999986692642628,
                                               'recall_1': 'nan',
                                               'recall_avg': 'nan',
                                               'specificity_0': 'nan',
                                               'specificity_1': 0.9999986692642628,
                                               'specificity_avg': 0.9999986692642628}}

1702484560992 cerebriu-research-bm48gpu-instance-2:gpu4 DEBUG 2023-12-13 16:22:36 INFO     [9/22] Evaluating study sub-217.

1702484566034 cerebriu-research-bm48gpu-instance-2:gpu4 DEBUG 2023-12-13 16:22:44 INFO     Study evaluation:
                             {'classification': {0: 'FP',
                                                 1: 'FN'},
                              'counts': {'predicted_counts': [0],
                                         'predicted_overlapping_counts': [0],
                                         'true_counts': [1]},
                              'segmentation': {'f1_0': 0.9999969951593609,
                                               'f1_1': 0.0,
                                               'f1_avg': 0.0,
                                               'precision_0': 0.9999939903367799,
                                               'precision_1': 'nan',
                                               'precision_avg': 'nan',
                                               'recall_0': 1.0,
                                               'recall_1': 0.0,
                                               'recall_avg': 0.0,
                                               'specificity_0': 0.0,
                                               'specificity_1': 1.0,
                                               'specificity_avg': 1.0}}

1702484571042 cerebriu-research-bm48gpu-instance-2:gpu4 DEBUG 2023-12-13 16:22:47 INFO     [10/22] Evaluating study sub-219.

1702484576083 cerebriu-research-bm48gpu-instance-2:gpu4 DEBUG 2023-12-13 16:22:55 INFO     Study evaluation:
                             {'classification': {0: 'TP',
                                                 1: 'TN'},
                              'counts': {'predicted_counts': [0],
                                         'predicted_overlapping_counts': [0],
                                         'true_counts': [0]},
                              'segmentation': {'f1_0': 1.0,
                                               'f1_1': 'nan',
                                               'f1_avg': 'nan',
                                               'precision_0': 1.0,
                                               'precision_1': 'nan',
                                               'precision_avg': 'nan',
                                               'recall_0': 1.0,
                                               'recall_1': 'nan',
                                               'recall_avg': 'nan',
                                               'specificity_0': 'nan',
                                               'specificity_1': 1.0,
                                               'specificity_avg': 1.0}}

1702484581099 cerebriu-research-bm48gpu-instance-2:gpu4 DEBUG 2023-12-13 16:22:58 INFO     [11/22] Evaluating study sub-221.

1702484591145 cerebriu-research-bm48gpu-instance-2:gpu4 DEBUG 2023-12-13 16:23:08 INFO     Study evaluation:
                             {'classification': {0: 'TN',
                                                 1: 'TP'},
                              'counts': {'predicted_counts': [16],
                                         'predicted_overlapping_counts': [10],
                                         'true_counts': [11]},
                              'segmentation': {'f1_0': 0.9999901304712095,
                                               'f1_1': 0.5981182795698925,
                                               'f1_avg': 0.5981182795698925,
                                               'precision_0': 0.9999899654305783,
                                               'precision_1': 0.6021650879566982,
                                               'precision_avg': 0.6021650879566982,
                                               'recall_0': 0.9999902955118954,
                                               'recall_1': 0.5941255006675568,
                                               'recall_avg': 0.5941255006675568,
                                               'specificity_0': 0.5941255006675568,
                                               'specificity_1': 0.9999902955118954,
                                               'specificity_avg': 0.9999902955118954}}

1702484596151 cerebriu-research-bm48gpu-instance-2:gpu4 DEBUG 2023-12-13 16:23:11 INFO     [12/22] Evaluating study sub-222.

1702484601193 cerebriu-research-bm48gpu-instance-2:gpu4 DEBUG 2023-12-13 16:23:20 INFO     Study evaluation:
                             {'classification': {0: 'TN',
                                                 1: 'TP'},
                              'counts': {'predicted_counts': [8],
                                         'predicted_overlapping_counts': [4],
                                         'true_counts': [11]},
                              'segmentation': {'f1_0': 0.9999853155576692,
                                               'f1_1': 0.21234119782214156,
                                               'f1_avg': 0.21234119782214156,
                                               'precision_0': 0.9999792591967023,
                                               'precision_1': 0.31451612903225806,
                                               'precision_avg': 0.31451612903225806,
                                               'recall_0': 0.9999913719919973,
                                               'recall_1': 0.16027397260273973,
                                               'recall_avg': 0.16027397260273973,
                                               'specificity_0': 0.16027397260273973,
                                               'specificity_1': 0.9999913719919973,
                                               'specificity_avg': 0.9999913719919973}}

1702484606201 cerebriu-research-bm48gpu-instance-2:gpu4 DEBUG 2023-12-13 16:23:22 INFO     [13/22] Evaluating study sub-226.

1702484611241 cerebriu-research-bm48gpu-instance-2:gpu4 DEBUG 2023-12-13 16:23:29 INFO     Study evaluation:
                             {'classification': {0: 'TP',
                                                 1: 'TN'},
                              'counts': {'predicted_counts': [0],
                                         'predicted_overlapping_counts': [0],
                                         'true_counts': [0]},
                              'segmentation': {'f1_0': 1.0,
                                               'f1_1': 'nan',
                                               'f1_avg': 'nan',
                                               'precision_0': 1.0,
                                               'precision_1': 'nan',
                                               'precision_avg': 'nan',
                                               'recall_0': 1.0,
                                               'recall_1': 'nan',
                                               'recall_avg': 'nan',
                                               'specificity_0': 'nan',
                                               'specificity_1': 1.0,
                                               'specificity_avg': 1.0}}

1702484616247 cerebriu-research-bm48gpu-instance-2:gpu4 DEBUG 2023-12-13 16:23:32 INFO     [14/22] Evaluating study sub-229.

1702484626296 cerebriu-research-bm48gpu-instance-2:gpu4 DEBUG 2023-12-13 16:23:41 INFO     Study evaluation:
                             {'classification': {0: 'TN',
                                                 1: 'TP'},
                              'counts': {'predicted_counts': [1],
                                         'predicted_overlapping_counts': [0],
                                         'true_counts': [1]},
                              'segmentation': {'f1_0': 0.9999989342263096,
                                               'f1_1': 0.0,
                                               'f1_avg': 0.0,
                                               'precision_0': 0.9999991223038546,
                                               'precision_1': 0.0,
                                               'precision_avg': 0.0,
                                               'recall_0': 0.9999987461488353,
                                               'recall_1': 0.0,
                                               'recall_avg': 0.0,
                                               'specificity_0': 0.0,
                                               'specificity_1': 0.9999987461488353,
                                               'specificity_avg': 0.9999987461488353}}
2023-12-13 16:23:44 INFO     [15/22] Evaluating study sub-232.

1702484636326 cerebriu-research-bm48gpu-instance-2:gpu4 DEBUG 2023-12-13 16:23:51 INFO     Study evaluation:
                             {'classification': {0: 'TN',
                                                 1: 'TP'},
                              'counts': {'predicted_counts': [1],
                                         'predicted_overlapping_counts': [1],
                                         'true_counts': [1]},
                              'segmentation': {'f1_0': 0.9999995886682329,
                                               'f1_1': 0.7586206896551724,
                                               'f1_avg': 0.7586206896551724,
                                               'precision_0': 0.9999995690810143,
                                               'precision_1': 0.7674418604651163,
                                               'precision_avg': 0.7674418604651163,
                                               'recall_0': 0.9999996082554522,
                                               'recall_1': 0.75,
                                               'recall_avg': 0.75,
                                               'specificity_0': 0.75,
                                               'specificity_1': 0.9999996082554522,
                                               'specificity_avg': 0.9999996082554522}}
2023-12-13 16:23:54 INFO     [16/22] Evaluating study sub-302.

1702484646365 cerebriu-research-bm48gpu-instance-2:gpu4 DEBUG 2023-12-13 16:24:03 INFO     Study evaluation:
                             {'classification': {0: 'TN',
                                                 1: 'TP'},
                              'counts': {'predicted_counts': [6],
                                         'predicted_overlapping_counts': [1],
                                         'true_counts': [1]},
                              'segmentation': {'f1_0': 0.9999904934351774,
                                               'f1_1': 0.5598621877691645,
                                               'f1_avg': 0.5598621877691645,
                                               'precision_0': 0.9999870889754883,
                                               'precision_1': 0.6646216768916156,
                                               'precision_avg': 0.6646216768916156,
                                               'recall_0': 0.9999938979180478,
                                               'recall_1': 0.4836309523809524,
                                               'recall_avg': 0.4836309523809524,
                                               'specificity_0': 0.4836309523809524,
                                               'specificity_1': 0.9999938979180478,
                                               'specificity_avg': 0.9999938979180478}}

1702484651372 cerebriu-research-bm48gpu-instance-2:gpu4 DEBUG 2023-12-13 16:24:06 INFO     [17/22] Evaluating study sub-303.
ClearML Monitor: Could not detect iteration reporting, falling back to iterations as seconds-from-start

1702484661420 cerebriu-research-bm48gpu-instance-2:gpu4 DEBUG 2023-12-13 16:24:16 INFO     Study evaluation:
                             {'classification': {0: 'TN',
                                                 1: 'TP'},
                              'counts': {'predicted_counts': [2],
                                         'predicted_overlapping_counts': [1],
                                         'true_counts': [1]},
                              'segmentation': {'f1_0': 0.9999977200083736,
                                               'f1_1': 0.4731182795698925,
                                               'f1_avg': 0.4731182795698925,
                                               'precision_0': 0.9999990383696109,
                                               'precision_1': 0.3626373626373626,
                                               'precision_avg': 0.3626373626373626,
                                               'recall_0': 0.9999964016506125,
                                               'recall_1': 0.6804123711340206,
                                               'recall_avg': 0.6804123711340206,
                                               'specificity_0': 0.6804123711340206,
                                               'specificity_1': 0.9999964016506125,
                                               'specificity_avg': 0.9999964016506125}}
2023-12-13 16:24:19 INFO     [18/22] Evaluating study sub-307.

1702484671462 cerebriu-research-bm48gpu-instance-2:gpu4 DEBUG 2023-12-13 16:24:27 INFO     Study evaluation:
                             {'classification': {0: 'TN',
                                                 1: 'TP'},
                              'counts': {'predicted_counts': [2],
                                         'predicted_overlapping_counts': [1],
                                         'true_counts': [1]},
                              'segmentation': {'f1_0': 0.999997909451646,
                                               'f1_1': 0.607773851590106,
                                               'f1_avg': 0.607773851590106,
                                               'precision_0': 0.9999996233239753,
                                               'precision_1': 0.45989304812834225,
                                               'precision_avg': 0.45989304812834225,
                                               'recall_0': 0.9999961955851914,
                                               'recall_1': 0.8958333333333334,
                                               'recall_avg': 0.8958333333333334,
                                               'specificity_0': 0.8958333333333334,
                                               'specificity_1': 0.9999961955851914,
                                               'specificity_avg': 0.9999961955851914}}
2023-12-13 16:24:30 INFO     [19/22] Evaluating study sub-309.

1702484681494 cerebriu-research-bm48gpu-instance-2:gpu4 DEBUG 2023-12-13 16:24:39 INFO     Study evaluation:
                             {'classification': {0: 'TN',
                                                 1: 'TP'},
                              'counts': {'predicted_counts': [5],
                                         'predicted_overlapping_counts': [1],
                                         'true_counts': [1]},
                              'segmentation': {'f1_0': 0.9999941356867373,
                                               'f1_1': 0.32,
                                               'f1_avg': 0.32,
                                               'precision_0': 0.9999975671186573,
                                               'precision_1': 0.2289156626506024,
                                               'precision_avg': 0.2289156626506024,
                                               'recall_0': 0.9999907042783668,
                                               'recall_1': 0.5314685314685315,
                                               'recall_avg': 0.5314685314685315,
                                               'specificity_0': 0.5314685314685315,
                                               'specificity_1': 0.9999907042783668,
                                               'specificity_avg': 0.9999907042783668}}

1702484686500 cerebriu-research-bm48gpu-instance-2:gpu4 DEBUG 2023-12-13 16:24:42 INFO     [20/22] Evaluating study sub-311.

1702484696547 cerebriu-research-bm48gpu-instance-2:gpu4 DEBUG 2023-12-13 16:24:52 INFO     Study evaluation:
                             {'classification': {0: 'TN',
                                                 1: 'TP'},
                              'counts': {'predicted_counts': [6],
                                         'predicted_overlapping_counts': [1],
                                         'true_counts': [1]},
                              'segmentation': {'f1_0': 0.9999916689592176,
                                               'f1_1': 0.5655608214849921,
                                               'f1_avg': 0.5655608214849921,
                                               'precision_0': 0.9999898512960395,
                                               'precision_1': 0.62478184991274,
                                               'precision_avg': 0.62478184991274,
                                               'recall_0': 0.9999934866290037,
                                               'recall_1': 0.5165945165945166,
                                               'recall_avg': 0.5165945165945166,
                                               'specificity_0': 0.5165945165945166,
                                               'specificity_1': 0.9999934866290037,
                                               'specificity_avg': 0.9999934866290037}}

1702484701564 cerebriu-research-bm48gpu-instance-2:gpu4 DEBUG 2023-12-13 16:24:56 INFO     [21/22] Evaluating study sub-312.

1702484711612 cerebriu-research-bm48gpu-instance-2:gpu4 DEBUG 2023-12-13 16:25:06 INFO     Study evaluation:
                             {'classification': {0: 'TN',
                                                 1: 'TP'},
                              'counts': {'predicted_counts': [5],
                                         'predicted_overlapping_counts': [2],
                                         'true_counts': [2]},
                              'segmentation': {'f1_0': 0.9999976988877597,
                                               'f1_1': 0.5793871866295265,
                                               'f1_avg': 0.5793871866295265,
                                               'precision_0': 0.9999972874317202,
                                               'precision_1': 0.6265060240963856,
                                               'precision_avg': 0.6265060240963856,
                                               'recall_0': 0.9999981103441378,
                                               'recall_1': 0.538860103626943,
                                               'recall_avg': 0.538860103626943,
                                               'specificity_0': 0.538860103626943,
                                               'specificity_1': 0.9999981103441378,
                                               'specificity_avg': 0.9999981103441378}}
2023-12-13 16:25:10 INFO     [22/22] Evaluating study sub-314.

1702484726674 cerebriu-research-bm48gpu-instance-2:gpu4 DEBUG 2023-12-13 16:25:23 INFO     Study evaluation:
                             {'classification': {0: 'TN',
                                                 1: 'TP'},
                              'counts': {'predicted_counts': [2],
                                         'predicted_overlapping_counts': [1],
                                         'true_counts': [1]},
                              'segmentation': {'f1_0': 0.9999985330524651,
                                               'f1_1': 0.24675324675324675,
                                               'f1_avg': 0.24675324675324675,
                                               'precision_0': 0.9999980272094855,
                                               'precision_1': 0.3333333333333333,
                                               'precision_avg': 0.3333333333333333,
                                               'recall_0': 0.9999990388959565,
                                               'recall_1': 0.1958762886597938,
                                               'recall_avg': 0.1958762886597938,
                                               'specificity_0': 0.1958762886597938,
                                               'specificity_1': 0.9999990388959565,
                                               'specificity_avg': 0.9999990388959565}}
Traceback (most recent call last):
  File "/4_datadrive/clearml/venvs-builds.5/3.11/task_repository/cerebriu-research-mlops.git/crbr/commands/main.py", line 222, in <module>
    main()
  File "/4_datadrive/clearml/venvs-builds.5/3.11/task_repository/cerebriu-research-mlops.git/crbr/commands/main.py", line 218, in main
    return mod.main(task=task, config=config, local_run_dir=local_run_dir)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/4_datadrive/clearml/venvs-builds.5/3.11/task_repository/cerebriu-research-mlops.git/crbr/utils/config_parsers.py", line 543, in wrapper
    return func(task, config, local_run_dir, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/4_datadrive/clearml/venvs-builds.5/3.11/task_repository/cerebriu-research-mlops.git/crbr/utils/clearml_utils.py", line 477, in wrapper
    return func(task, config, local_run_dir, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/4_datadrive/clearml/venvs-builds.5/3.11/task_repository/cerebriu-research-mlops.git/crbr/commands/evaluate.py", line 453, in main
    evaluate_prediction_artefact(
  File "/4_datadrive/clearml/venvs-builds.5/3.11/task_repository/cerebriu-research-mlops.git/crbr/commands/evaluate.py", line 352, in evaluate_prediction_artefact
    evaluation_metrics = run_all_evaluations_on_dataset(
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/4_datadrive/clearml/venvs-builds.5/3.11/task_repository/cerebriu-research-mlops.git/crbr/commands/evaluate.py", line 229, in run_all_evaluations_on_dataset
    add_accumulated_metrics(evaluation_metrics, evaluations, task)
  File "/4_datadrive/clearml/venvs-builds.5/3.11/task_repository/cerebriu-research-mlops.git/crbr/commands/evaluate.py", line 255, in add_accumulated_metrics
    evaluation.reset_accumulator()
  File "/4_datadrive/clearml/venvs-builds.5/3.11/task_repository/cerebriu-research-mlops.git/crbr/evaluation/evaluations/base_evaluation.py", line 191, in reset_accumulator
    raise NotImplementedError("Must be implemented in subclass")
NotImplementedError: Must be implemented in subclass

1702484731657 cerebriu-research-bm48gpu-instance-2:gpu4 DEBUG Process failed, exit code 1
